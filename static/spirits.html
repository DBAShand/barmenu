<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸ¥ƒ House Spirits â€“ MizzouGlennâ€™s Tavern</title>
<link rel="stylesheet" href="/static/main.css">
</head>
<body>
  <header class="menu-header">
    <div class="mizzou-logo">
      <div class="logo-row">
        <span class="tile"><span>M</span></span>
        <span class="tile"><span>I</span></span>
        <span class="tile"><span>Z</span></span>
        <span class="tile"><span>Z</span></span>
        <span class="tile"><span>O</span></span>
        <span class="tile"><span>U</span></span>
      </div>
      <div class="logo-row">
        <span class="tile"><span>G</span></span>
        <span class="tile"><span>L</span></span>
        <span class="tile"><span>E</span></span>
        <span class="tile"><span>N</span></span>
        <span class="tile"><span>N</span></span>
        <span class="tile"><span>S</span></span>
      </div>
    </div>
    <div class="brand-name">Tavern</div>
  </header>

  <div class="board">
    <h1 class="title" id="group-name">Loading...</h1>
    <ul id="spirits"></ul>
    <div class="footer">MizzouGlennâ€™s Tavern â€” Where Every Nightâ€™s a Home Game</div>
  </div>

  <script>
  const groups = {
    "Bourbon": ["bourbon"],
    "Rye": ["rye"],
    "Scotch / Whiskey": ["whiskey", "scotch"],
    "Gin": ["gin"],
    "Vodka": ["vodka"],
    "Rum": ["rum"],
    "Liqueurs & Cordials & Aperitifs & Absinthe": [
      "liqueur", "cream liqueur", "orange liqueur", "herbal liqueur",
      "elderflower liqueur","aperitif", "absinthe"
    ],
    "Tequila / Mezcal": ["tequila", "mezcal"],
  };

  const params = new URLSearchParams(window.location.search);
  const groupParam = params.get("group") || "Bourbon";
  let spiritsData = [];

  async function loadSpirits() {
    try {
      const res = await fetch('/api/spirits');
      spiritsData = await res.json();
      showGroup(groupParam);
    } catch (err) {
      document.getElementById('group-name').textContent = 'Error loading spirits';
    }
  }

  function showGroup(groupName) {
    const types = groups[groupName];
    document.getElementById('group-name').textContent = groupName;

    if (!types) {
      document.getElementById('spirits').innerHTML = `<li>Unknown group</li>`;
      return;
    }

    const filtered = spiritsData.filter(s =>
      types.some(t => s.type.toLowerCase().includes(t))
    );

    filtered.sort((a, b) => a.name.localeCompare(b.name));

    const list = document.getElementById('spirits');
    list.innerHTML = filtered.map(s =>
      `<li>
         <span class="drink">${s.name}</span>
         <span class="meta">${s.origin || ''}</span>
       </li>`
    ).join('');
  }

  loadSpirits();
  </script>
  <script>
    if (window.self !== window.top) {
      document.body.classList.add('display');
      document.documentElement.classList.add('display');
    }
  </script>
</body>
</html>